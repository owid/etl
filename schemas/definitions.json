{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "license": {
    "type": "object",
    "title": "License of the dataset",
    "description": "An origin's license is the license, assigned by a producer, of the data product from where we extracted the indicator's original data and metadata.",
    "requirement_level": "required",
    "category": "license",
    "additionalProperties": false,
    "properties": {
      "name": {
        "type": "string",
        "title": "License name",
        "description": "Name of the license.",
        "requirement_level": "required",
        "examples": [
          "Public domain",
          "CC0",
          "PDM",
          "CC BY 4.0",
          "CC BY-SA 4.0",
          "© GISAID 2023"
        ],
        "options": [
          "Public domain",
          "CC0",
          "PDM",
          "CC BY 4.0",
          "CC BY-SA 4.0",
          "CC BY-ND 4.0",
          "CC BY-NC 4.0",
          "CC BY-NC-SA 4.0",
          "CC BY-NC-ND 4.0",
          "©producer year",
          "custom license"
        ],
        "examples_bad": [],
        "guidelines": [
          ["If it's a standard license, e.g. CC, it should be one of the acronyms in the examples below."],
          ["If the license is CC, but the version is not specified, assume 4.0."],
          ["If it's a custom license defined by the producer, it should follow the producer's text."],
          ["When the license of an external dataset is not specified, temporarily assume `CC BY 4.0`. Contact the producer before publishing.", {"type": "list", "value": ["If there is no response after a few days, ask Ed or Este and decide on a case-by-case basis."]}]
        ],
        "category": "license"
      },
      "url": {
        "type": "string",
        "title": "License URL",
        "description": "URL leading to the producer's website where the dataset license is specified.",
        "pattern": "/(https:\/\/www\\.|http:\/\/www\\.|https:\/\/|http:\/\/)?[a-zA-Z]{2,}(\\.[a-zA-Z]{2,})(\\.[a-zA-Z]{2,})?\/[a-zA-Z0-9]{2,}|((https:\/\/www\\.|http:\/\/www\\.|https:\/\/|http:\/\/)?[a-zA-Z]{2,}(\\.[a-zA-Z]{2,})(\\.[a-zA-Z]{2,})?)|(https:\/\/www\\.|http:\/\/www\\.|https:\/\/|http:\/\/)?[a-zA-Z0-9]{2,}\\.[a-zA-Z0-9]{2,}\\.[a-zA-Z0-9]{2,}(\\.[a-zA-Z0-9]{2,})?/g;",
        "errorMessage": "'license.url' must be a valid URL",
        "requirement_level": "required (if existing)",
        "examples": [],
        "examples_bad": [],
        "guidelines": [
          ["Must be a complete URL, i.e. `http...` ."],
          ["Must not lead to a Creative Commons website or any other generic page, but to the place where the producer specifies the license of the data."],
          ["If the license is specified inside, say, a PDF document, the URL should be the download link of that document."],
          ["When the license of an external dataset is not specified, leave `url` empty.", {"type": "list", "value": ["Do not use the URL of the main page of the dataset if the license is not mentioned anywhere."]}]
        ],
        "category": "license"
      }
    }
  },
  "source": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "name": {
        "type": "string"
      },
      "url": {
        "type": "string"
      },
      "owid_data_url": {
        "type": "string"
      },
      "source_data_url": {
        "type": "string"
      },
      "date_accessed": {
        "anyOf": [
          {
            "type": "string",
            "format": "date"
          },
          {
            "type": "string",
            "pattern": "^\\{.*\\}$"
          }
        ]
      },
      "description": {
        "type": "string"
      },
      "publication_year": {
        "type": "integer"
      },
      "publication_date": {
        "anyOf": [
          {
            "type": "string",
            "format": "date"
          },
          {
            "type": "string",
            "pattern": "^\\{.*\\}$"
          }
        ]
      },
      "published_by": {
        "type": "string"
      }
    },
    "required": ["name"]
  },
  "origin": {
    "type": "object",
    "description": "An indicator's origin is the information about the snapshot where the indicator's data and metadata came from. A snapshot is a subset of data (a 'slice') taken on a specific day from a data product (often a public dataset, but sometimes a paper or a database). The producer of the data product is typically an institution or a set of authors. Note: A snapshot often coincides with the data product (e.g. the dataset is a public csv file, and we download the entire file). But sometimes the data product is a bigger object (e.g. a set of files, a paper or a database) and the snapshot is just a particular subset of the data product (e.g. one of the files, or a table from a paper, or the result of a query). The origin fields are the attributes of the `Origin` object in ETL.",
    "additionalProperties": false,
    "required": ["producer", "date_published", "date_accessed", "citation_producer", "url_main", "dataset_title_owid"],
    "properties": {
      "producer": {
        "title": "Producer name",
        "type": "string",
        "description": "Name of the institution or the author(s) that produced the data product.",
        "examples": [
          "NASA",
          "World Bank",
          "Williams et al.",
          "van Haasteren et al.",
          "Williams and Jones"
        ],
        "examples_bad": [
          [
            "NASA (2023)",
            "N.A.S.A.",
            "N A S A",
            "National Aeronautics and Space Administration",
            "Our World in Data based on NASA"
          ],
          ["WB"],
          [
            "Williams et al. (2023)",
            "Williams et al",
            "John Williams et al."
          ],
          [
            "Van Haasteren et al."
          ],
          [
            "Williams & Jones",
            "John Williams and Indiana Jones"
          ]
        ],
        "requirement_level": "required",
        "guidelines": [
          ["Must start with a capital letter.", {"type": "exceptions", "value": ["The name of the institution or the author must be spelled with small letter, e.g. `van Haasteren`."]}],
          ["Must not end with a period.", {"type": "exceptions", "value": ["When using `et al.` (for papers with multiple authors)."]}],
          ["Must not include a date or year."],
          ["Must not mention `Our World in Data` or `OWID`."],
          ["Must not include any semicolon `;`."],
          ["Regarding authors:", {"type": "list", "value": ["One author: `Williams`.", "Two authors: `Williams and Jones`.", "Three or more authors: `Williams et al.`."]}],
          ["Regarding acronyms:", {"type": "list", "value": ["If the acronym is more well known than the full name, use just the acronym, e.g. `NASA`.", "If the acronym is not well known, use the full name, e.g. `Energy Institute`.", "If the institution explicitly asks, follow their guidelines, e.g. `Food and Agriculture Organization of the United Nations` (instead of `FAO`)."]}]
        ],
        "category": "citation"
      },
      "date_published": {
        "title": "Date of publication of the original data",
        "type": "string",
        "description": "Exact day (or year, if exact day is unknown) when the producer's data (in its current version) was published.",
        "examples": ["2023-09-07", "2023", "latest"],
        "examples_bad": [],
        "requirement_level": "required",
        "guidelines": [
          ["Must be a date with format `YYYY-MM-DD`, or, exceptionally, `YYYY`."],
          ["Must be the date when the current version of the dataset was published (not when the dataset was first released)."]
        ],
        "pattern": "(^\\d\\d\\d\\d\\-\\d\\d\\-\\d\\d$)|(^\\d{4}$)|(^latest$)",
        "errorMessage": "`date_published` must have format YYYY-MM-DD, YYYY or 'latest'",
        "category": "dataset"
      },
      "date_accessed": {
        "title": "Date when we accessed the producer's original data",
        "type": "string",
        "format": "date",
        "description": "Exact day when the producer's data (in its current version) was downloaded by OWID.",
        "examples": ["2023-09-07"],
        "examples_bad": [],
        "requirement_level": "required",
        "guidelines": [
          ["Must be a date with format `YYYY-MM-DD`."],
          ["Must be the date when the current version of the producer's data was accessed (not any other previous version)."]
        ],
        "pattern": "^\\d\\d\\d\\d\\-\\d\\d\\-\\d\\d$",
        "errorMessage": "`date_accessed` must have format YYYY-MM-DD",
        "category": "files"
      },
      "citation_producer": {
        "title": "Full citation",
        "type": "string",
        "description": "Full citation of the origin. If the producer expressed how to cite them, we should follow their recommendations.",
        "examples": [],
        "examples_bad": [],
        "requirement_level": "required",
        "guidelines": [
          ["Must start with a capital letter."],
          ["Must end with a period."],
          ["If the producer specified how to cite them, this field should be identical to the producer's text, except for some formatting changes, typo corrections, or other appropriate minor edits.", {"type": "list", "value": ["**Note:** This field can be as long as necessary to follow the producer's guidelines."]}],
          ["If the origin is the compilation of multiple sources, they can be added here as a list."]
        ],
        "category": "citation"
      },
      "url_main": {
        "title": "URL of the main website of the data product",
        "type": "string",
        "description": "Producer's URL leading to the main website of the original dataset.",
        "requirement_level": "required",
        "guidelines": [
          ["Must be a complete URL, i.e. `http...`."],
          ["Should lead to a website where the dataset is described."]
        ],
        "pattern": "/(https:\/\/www\\.|http:\/\/www\\.|https:\/\/|http:\/\/)?[a-zA-Z]{2,}(\\.[a-zA-Z]{2,})(\\.[a-zA-Z]{2,})?\/[a-zA-Z0-9]{2,}|((https:\/\/www\\.|http:\/\/www\\.|https:\/\/|http:\/\/)?[a-zA-Z]{2,}(\\.[a-zA-Z]{2,})(\\.[a-zA-Z]{2,})?)|(https:\/\/www\\.|http:\/\/www\\.|https:\/\/|http:\/\/)?[a-zA-Z0-9]{2,}\\.[a-zA-Z0-9]{2,}\\.[a-zA-Z0-9]{2,}(\\.[a-zA-Z0-9]{2,})?/g;",
        "errorMessage": "'url_main' must be valid URL",
        "examples": [
          "https://data.some_institution.com/dataset_12"
        ],
        "examples_bad": [],
        "category": "files"
      },
      "url_download": {
        "title": "URL to download the data product",
        "type": "string",
        "description": "Producer's URL that directly downloads the data product as a single file.",
        "pattern": "/(https:\/\/www\\.|http:\/\/www\\.|https:\/\/|http:\/\/)?[a-zA-Z]{2,}(\\.[a-zA-Z]{2,})(\\.[a-zA-Z]{2,})?\/[a-zA-Z0-9]{2,}|((https:\/\/www\\.|http:\/\/www\\.|https:\/\/|http:\/\/)?[a-zA-Z]{2,}(\\.[a-zA-Z]{2,})(\\.[a-zA-Z]{2,})?)|(https:\/\/www\\.|http:\/\/www\\.|https:\/\/|http:\/\/)?[a-zA-Z0-9]{2,}\\.[a-zA-Z0-9]{2,}\\.[a-zA-Z0-9]{2,}(\\.[a-zA-Z0-9]{2,})?/g;",
        "errorMessage": "'url_download' must be a valid URL",
        "requirement_level": "required (if existing)",
        "guidelines": [
          ["Must be a complete URL, i.e. `http...`."],
          ["Must be a direct download link.", {"type": "list", "value": ["The URL must not lead to a website that requires user input to download the dataset. If there is no direct download URL, this field should be empty."]}]
        ],
        "examples": [
          "https://data.some_institution.com/dataset_12/data.csv"
        ],
        "examples_bad": [],
        "category": "files"
      },
      "title": {
        "title": "Title of the original data product",
        "type": "string",
        "description": "Title of the original data product.",
        "examples": ["Global Carbon Budget"],
        "examples_bad": [["Global Carbon Budget (fossil fuels)"]],
        "requirement_level": "recommended (if existing)",
        "guidelines": [
          ["Must start with a capital letter."],
          ["Must not end with a period."],
          ["Should identify the data product, not the subset of data we extract from it."]
        ],
        "category": "dataset"
      },
      "description": {
        "title": "Description of the data product",
        "type": "string",
        "description": "Description of the original data product.",
        "examples": [],
        "examples_bad": [],
        "requirement_level": "recommended",
        "guidelines": [
          ["Must start with a capital letter."],
          ["Must end with a period."],
          ["Should describe the data product, not the snapshot (i.e. the subset of data we extract from the data product)."]
        ],
        "category": "dataset"
      },
      "dataset_title_owid": {
        "title": "Title of the snapshot",
        "type": "string",
        "description": "Title of the snapshot (i.e. the subset of data that we extract from the data product) which in most cases will coincide with the title of the data product.",
        "examples": [
          "Neutron star mergers"
        ],
        "examples_bad": [
          [
            "Neutron star mergers (NASA, 2023)",
            "Data on neutron star mergers",
            "Neutron star mergers dataset"
          ]
        ],
        "requirement_level": "recommended (if different from `data_product_title`)",
        "guidelines": [
          ["Must start with a capital letter."],
          ["Must not end with a period."],
          ["Must not mention other metadata fields like `producer` or `version_producer`.", {"type": "exceptions", "value": ["The name of the origin is well known and includes other metadata fields."]}],
          ["Must not include any semicolon `;`."],
          ["Should not include words like `data`, `dataset` or `database`, unless that's part of a well-known name of the origin."],
          ["Should be descriptive of the content of the origin.", {"type": "exceptions", "value": ["The origin's title is well known but not descriptive, e.g. `Penn World Table`."]}]
        ],
        "category": "dataset"
      },
      "dataset_description_owid": {
        "title": "Description of the snapshot",
        "type": "string",
        "description": "Description of the snapshot (i.e. the subset of data that we extract from the data product) which in most cases will coincide with the description of the data product.",
        "requirement_level": "recommended",
        "guidelines": [
          ["Must start with a capital letter."],
          ["Must end with a period."],
          ["Should not mention other metadata fields.", {"type": "list", "value": ["If fields like `producer` or `date_published` are mentioned, placeholders should be used."]}]
        ],
        "examples": [],
        "examples_bad": [],
        "category": "dataset"
      },
      "attribution": {
        "type": "string",
        "title": "Attribution",
        "description": "Short citation of the producer and publication year (and sometimes the dataset) that overrides the automatic attribution format `producer (year)` (where the year is automatically extracted from `date_published`).",
        "requirement_level": "optional",
        "examples": [
          "Statistical Review of World Energy, Energy Institute (2023)"
        ],
        "examples_bad": [
          ["Energy Institute - Statistical Review of World Energy (2023)"]
        ],
        "guidelines": [
          ["Must start with a capital letter.", {"type": "exceptions", "value": ["The name of the institution or the author must be spelled with small letter, e.g. `van Haasteren`."]}],
          ["Must not end with a period."],
          ["Must end with the year of `date_published` in parenthesis."],
          ["Must not include any semicolon `;`."],
          ["Should only be used if the automatic attribution format `producer (year)`is incomplete. For example, when the dataset title is well known and should be cited along with the producer, or when the original dataset version should also be mentioned."],
          ["Should be constructed using placeholders, e.g. `{dataset_title_owid}, {producer} ({year})`."]
        ],
        "category": "citation"
      },
      "attribution_short": {
        "type": "string",
        "title": "Attribution (shorter version)",
        "description": "Shorter version of `attribution` (without the year), usually an acronym, to be used in public places that are short on space.",
        "requirement_level": "recommended",
        "examples": [
          "FAO",
          "World Bank"
        ],
        "examples_bad": [
          [
            "UN FAO",
            "FAO (2023)"
          ],
          ["WB"]
        ],
        "guidelines": [
          ["Must start with a capital letter.", {"type": "exceptions", "value": ["The name of the institution or the author must be spelled with small letter, e.g. `van Haasteren`."]}],
          ["Must not end with a period."],
          ["Should refer to the producer or the dataset title (if well known), not the year or any other field."],
          ["Should be an acronym, if the acronym is well-known, otherwise a brief name."]
        ],
        "category": "citation"
      },
      "version_producer": {
        "type": "string",
        "title": "Version of the data as given by the producer",
        "description": "Producer's version of the dataset.",
        "requirement_level": "recommended (if existing)",
        "examples": [],
        "examples_bad": [],
        "guidelines": [
          ["Should be used if the producer specifies the dataset version."],
          ["Should follow the same naming as the producer, e.g. `v13`, `2023.a`, `version II`."]
      ],
        "category": "dataset"
      },
      "license": { "$ref": "#/license" }
    }
  },
  "display": {
    "type": "object",
    "description": "We keep display for the time being as the 'less powerful sibling' of grapher config.",
    "properties": {
      "isProjection": {
        "type": "boolean",
        "default": false,
        "description": "Indicates if this time series is a forward projection (if so then this is rendered differently in e.g. line charts)."
      },
      "name": {
        "type": "string",
        "description": "Title to display for the indicator, to replace the indicator's `title`. NOTE: Currently, `grapher_config.title` will be used only in charts, whereas `display.name` will be used in other places, like the table tab."
      },
      "description": {
        "type": "string",
        "description": "Description to display for the indicator, to replace the indicator's `description`."
      },
      "tableDisplay": {
        "type": "object",
        "description": "Configuration for the table tab for this indicator, with options `hideAbsoluteChange` and `hideRelativeChange`.",
        "properties": {
          "hideAbsoluteChange": {
            "type": "boolean",
            "description": "Whether to hide the absolute change.",
            "default": false
          },
          "hideRelativeChange": {
            "type": "boolean",
            "description": "Whether to hide the relative change.",
            "default": false
          }
        },
        "additionalProperties": false
      },
      "tolerance": {
        "type": "integer",
        "default": 0,
        "description": "Tolerance (in years or days) to use in charts. If data points are missing, the closest data point will be shown, if it lies within the specified tolerance.",
        "minimum": 0
      },
      "entityAnnotationsMap": {
        "type": "string",
        "description": "Entity annotations"
      },
      "yearIsDay": {
        "type": "boolean",
        "default": false,
        "description": "Switch to indicate if the number in the year column represents a day (since zeroDay) or a year."
      },
      "color": {
        "type": "string",
        "description": "Color to use for the indicator in e.g. line charts."
      },
      "includeInTable": {
        "type": "boolean",
        "default": true,
        "description": "Whether to render this indicator in the table sheet."
      },
      "shortUnit": {
        "type": "string",
        "description": "Short unit to use in charts instead of the indicator's `short_unit`."
      },
      "conversionFactor": {
        "type": "number",
        "description": "Conversion factor to apply to indicator values. NOTE: We should avoid using this, and instead convert data and units (and possibly other metadata fields where the units are mentioned) consistently in the ETL grapher step."
      },
      "unit": {
        "type": "string",
        "description": "Unit to use in charts instead of the indicator's `unit`."
      },
      "numDecimalPlaces": {
        "type": "integer",
        "description": "Number of decimal places to show in charts (and in the table tab).",
        "minimum": 0
      },
      "zeroDay": {
        "type": "string",
        "description": "ISO date day string for the starting date if `yearIsDay` is `True`."
      }
    },
    "additionalProperties": false
  }
}
