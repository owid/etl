# ETL Browser Roadmap
*This was generated by Claude and is not set in stone. We may deviate a bit from this plan.*

## Completed (Phase 1+2)

- [x] Mode system with `BrowserMode` protocol
- [x] `ModeRegistry` for managing modes and auto-generating switch commands
- [x] `StepMode` wrapping existing step browser
- [x] `SnapshotMode` wrapping existing snapshot browser
- [x] `UnifiedBrowser` orchestrator
- [x] `etl -b` / `etl --browse` entry point
- [x] Per-mode history (`~/.cache/etl/browser_history/{mode}.json`)
- [x] In-place mode switching (stay in same textbox when switching modes)
- [x] Modern Python typing throughout browser module

## Phase 3: Unified Entry Point

- [ ] **Deprecate separate browser flags**
  - Deprecate `etlr -b` in favor of `etl -b` (steps mode)
  - Deprecate `etls -b` in favor of `etl -b /snapshots`
  - Eventually: `etl` with no subcommand opens the browser directly

- [ ] **Add deprecation warnings**
  - Show warning when using `etlr -b` or `etls -b`
  - Point users to `etl -b` as the unified entry point

## Phase 4: Additional Modes

- [ ] **HarmonizeMode** - Country harmonization browser
  - Browse unharmonized countries
  - Quick actions for common mappings

- [ ] **PRMode** - Pull request browser
  - Browse open PRs
  - Quick actions: checkout, review, merge

- [ ] **Other ETL commands integration**
  - Consider which commands benefit from browser UI
  - Potential candidates: `etl chart`, `etl variable`, `etl dataset`

## Phase 5: Claude/AI Integration

- [ ] **Programmatic API** (`etl/browser/api.py`)
  - `list_steps()`, `run_step()`, `get_step_info()`
  - `list_snapshots()`, `run_snapshot()`
  - Clean Python API for automation

- [ ] **MCP Tools**
  - Expose browser API as MCP tools
  - Enable Claude to browse and run ETL steps
  - Natural language step discovery

## Design Considerations

### Entry Point Evolution

Current:
```
etlr -b          # steps browser
etls -b          # snapshots browser
etl -b           # unified browser (new)
```

Future:
```
etl              # opens unified browser directly
etl steps        # runs step (existing)
etl -b           # explicit browser flag (backwards compat)
```

### Mode Protocol

New modes implement `BrowserMode` protocol (~20 lines):
```python
class MyMode(BaseBrowserMode):
    def __init__(self):
        super().__init__(ModeConfig(
            name="mymode",
            prompt="my> ",
            item_noun="item",
            item_noun_plural="items",
        ))

    def get_items_loader(self) -> Callable[[], list[str]]:
        return my_items_loader
```

### Claude Integration Architecture

```
User ─── Claude ─── MCP Tools ─── Browser API ─── ETL Pipeline
                         │
                    list_steps()
                    run_step()
                    get_info()
```
