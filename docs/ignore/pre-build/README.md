# Documentation Pre-build Scripts

This directory contains scripts that generate documentation during the pre-build phase. These scripts should be run before building the documentation with Zensical.

## Scripts Overview

### `bake_search_api.py` - Search API Documentation

Generates the Search API documentation from the OpenAPI specification.

**Source**: Fetched from GitHub at build time
- **Repository**: `owid/owid-grapher`
- **File Path**: `functions/search-api.openapi.yaml`
- **Branch**: `master`

This ensures the documentation always reflects the current state of the Search API in the grapher repository.

**Usage**:
```bash
python docs/ignore/pre-build/bake_search_api.py
```

**Output**: `docs/api/search-api.md`

**Local Development**: If you need to test changes before they're merged in `owid-grapher`, you can:
1. Temporarily modify the `load_openapi_spec_from_github()` function to use a local file
2. Or create a branch in `owid-grapher` and update the `branch` parameter in the script

---

### `bake_catalog_api.py` - Catalog API Documentation

Generates the Catalog API documentation by combining a template with content from the catalog library README.

**Source**:
- Template: `docs/ignore/pre-build/catalog-api.template.md`
- Content: `lib/catalog/README.md` (local file)

**Usage**:
```bash
python docs/ignore/pre-build/bake_catalog_api.py
```

**Output**: `docs/api/catalog-api.md`

---

### `bake_metadata_reference.py` - Metadata Reference Documentation

Generates dynamic metadata reference documentation that was previously generated by the mkdocs-gen-files plugin.

**Source**: Generated from ETL code using `etl.docs` module

**Usage**:
```bash
python docs/ignore/pre-build/bake_metadata_reference.py
```

**Outputs**:
- `docs/architecture/metadata/reference/index.md` (Metadata reference for Dataset, Table, Indicator, Origin)
- `docs/architecture/metadata/reference/collections.md` (Collections reference for MDIMs)

---

## Running All Scripts

To run all pre-build scripts, you can execute them individually or add them to your build pipeline:

```bash
python docs/ignore/pre-build/bake_search_api.py
python docs/ignore/pre-build/bake_catalog_api.py
python docs/ignore/pre-build/bake_metadata_reference.py
```
